<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Asistente de Inspección 5S</title>
    
    <!-- Librerías Externas -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/exceljs/4.3.0/exceljs.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">

    <style>
        :root {
            --primary-color: #3498db;
            --success-color: #2ecc71;
            --danger-color: #e74c3c;
            --neutral-color: #95a5a6; /* Color para N/A */
            --light-bg-color: #f8f9fa;
            --dark-text-color: #34495e;
            --light-text-color: #7f8c8d;
            --card-shadow: 0 10px 20px rgba(0,0,0,0.08);
            --border-radius: 12px;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--light-bg-color);
            color: var(--dark-text-color);
            padding: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
        }

        .container {
            width: 100%;
            max-width: 850px;
            background-color: #fff;
            padding: 30px 40px;
            border-radius: var(--border-radius);
            box-shadow: var(--card-shadow);
            overflow: hidden;
        }

        h1 {
            color: var(--dark-text-color);
            text-align: center;
            margin-bottom: 25px;
        }
        
        .general-data {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
            padding: 20px;
            background-color: #fdfdfd;
            border: 1px solid #ecf0f1;
            border-radius: var(--border-radius);
        }

        .data-field { display: flex; flex-direction: column; }
        .data-field label { font-weight: 500; margin-bottom: 5px; font-size: 0.9em; color: var(--light-text-color); }
        .data-field input { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 8px; font-family: 'Poppins', sans-serif; transition: border-color 0.3s; }
        .data-field input:focus { outline: none; border-color: var(--primary-color); }

        .progress-container {
            width: 100%;
            background-color: #e0e0e0;
            border-radius: 30px;
            margin-bottom: 10px;
            position: relative;
        }
        
        .progress-bar {
            width: 0%;
            height: 20px;
            background: linear-gradient(90deg, var(--primary-color), #8e44ad);
            border-radius: 30px;
            transition: width 0.4s ease-in-out;
        }
        
        .progress-text {
            position: absolute;
            width: 100%;
            text-align: center;
            top: 50%;
            transform: translateY(-50%);
            color: white;
            font-size: 12px;
            font-weight: 600;
        }

        .checklist-item {
            display: none; /* Ocultamos todas las preguntas por defecto */
            animation: fadeIn 0.5s;
        }
        
        .checklist-item.active {
            display: block; /* Mostramos solo la activa */
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .question-card {
            background-color: #fff;
            border: 1px solid #ecf0f1;
            border-radius: var(--border-radius);
            margin-bottom: 20px;
            padding: 30px;
            margin-top: 20px;
        }

        .category-header {
            text-align: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--primary-color);
        }

        .category-header h3 {
            font-size: 1.1em;
            font-weight: 600;
            color: var(--primary-color);
        }

        .question { font-size: 1.3em; font-weight: 600; margin-bottom: 25px; text-align: center; }
        .options { display: flex; flex-wrap: wrap; gap: 15px; }
        .options input[type="radio"] { display: none; }

        .options label {
            flex: 1;
            min-width: 120px;
            padding: 15px 20px;
            border-radius: 8px;
            border: 2px solid #ecf0f1;
            text-align: center;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
        }

        .options label i { margin-right: 8px; }
        .options input[value="Sí"]:checked + label { background-color: var(--success-color); border-color: var(--success-color); color: #fff; }
        .options input[value="No"]:checked + label { background-color: var(--danger-color); border-color: var(--danger-color); color: #fff; }
        .options input[value="No Aplica"]:checked + label { background-color: var(--neutral-color); border-color: var(--neutral-color); color: #fff; }

        .hidden-fields { max-height: 0; opacity: 0; overflow: hidden; transition: max-height 0.5s ease-out, opacity 0.3s ease-out, margin-top 0.5s ease-out; margin-top: 0; }
        .hidden-fields.visible { margin-top: 20px; max-height: 500px; opacity: 1; }
        .hidden-fields label { display: block; margin-bottom: 8px; font-weight: 500; }
        textarea { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 8px; font-family: 'Poppins', sans-serif; margin-bottom: 15px; transition: border-color 0.3s; }
        textarea:focus { outline: none; border-color: var(--primary-color); }
        
        input[type="file"] {
            display: none;
        }

        .file-upload-label {
            display: inline-block;
            padding: 12px 20px;
            background-color: var(--primary-color);
            color: #fff;
            font-weight: 500;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s;
            text-align: center;
        }

        .file-upload-label:hover {
            background-color: #2980b9;
        }

        .preview-container {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
        }

        .preview-wrapper {
            position: relative;
            width: 100px;
            height: 100px;
        }

        .preview-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 8px;
            border: 2px solid #ddd;
        }
        
        .delete-btn {
            position: absolute;
            top: -5px;
            right: -5px;
            width: 24px;
            height: 24px;
            background-color: var(--danger-color);
            color: white;
            border: 2px solid white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .delete-btn:hover {
            transform: scale(1.1);
        }

        .navigation-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }

        .nav-btn, .export-button {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            padding: 15px 30px;
            font-size: 1.1em;
            font-weight: 600;
            color: #fff;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.2s;
        }
        
        .nav-btn.prev { background-color: var(--light-text-color); }
        .nav-btn.prev:hover { background-color: var(--dark-text-color); transform: translateY(-2px); }
        .nav-btn.next { background-color: var(--primary-color); }
        .nav-btn.next:hover { background-color: #2980b9; transform: translateY(-2px); }
        .export-button { background-color: var(--success-color); width: 100%; }
        .export-button:hover { background-color: #27ae60; transform: translateY(-2px); }

        .nav-btn:disabled { background-color: #bdc3c7; cursor: not-allowed; transform: none; }
        .fa-spinner { animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

    </style>
</head>
<body>

    <div class="container">
        <h1>Asistente de Inspección 5S</h1>

        <div class="general-data">
            <div class="data-field"> <label for="auditor">Auditor:</label> <input type="text" id="auditor" name="auditor" placeholder="Nombre del inspector"> </div>
            <div class="data-field"> <label for="auditado">Auditado:</label> <input type="text" id="auditado" name="auditado" placeholder="Nombre del responsable"> </div>
            <div class="data-field"> <label for="area">Área:</label> <input type="text" id="area" name="area" placeholder="Ej: Taller, Oficina, etc."> </div>
            <div class="data-field"> <label for="fecha">Fecha:</label> <input type="date" id="fecha" name="fecha"> </div>
        </div>

        <div class="progress-container">
            <div class="progress-bar" id="progressBar"></div>
            <div class="progress-text" id="progressText"></div>
        </div>
        
        <form id="inspectionForm">
            <!-- Los ítems del checklist se generarán aquí con JavaScript -->
        </form>

        <div class="navigation-buttons">
            <button class="nav-btn prev" id="prevBtn" onclick="prevQuestion()"><i class="fas fa-arrow-left"></i> Anterior</button>
            <button class="nav-btn next" id="nextBtn" onclick="nextQuestion()">Siguiente <i class="fas fa-arrow-right"></i></button>
            <button class="export-button" id="exportBtn" onclick="exportToExcel()" style="display: none;"><i class="fas fa-file-excel"></i> Finalizar y Exportar</button>
        </div>
    </div>

    <script>
        // --- CONFIGURACIÓN ---
        const checklistData = [
            {
                phase: "1ra S",
                criteria: "ELIMINANDO INNECESARIO",
                questions: [
                    "¿Se encuentran en el área documentos físicos obsoletos?",
                    "¿Se encuentran en el área muebles innecesarios o dañados?",
                    "¿Se encuentran en el área equipos eléctricos y/o accesorios innecesarios o dañados?",
                    "¿Se encuentran otros objetos innecesarios y/o dañados en el área?",
                    "¿Se encuentran en el área instalaciones eléctricas innecesarias o cableado deteriorado?"
                ]
            },
            {
                phase: "2da S",
                criteria: "ORDEN",
                questions: [
                    "¿Existe un lugar definido para los documentos físicos?",
                    "¿Está ordenado los elementos en su escritorio?",
                    "¿Está ordenado su estante y/o muebles compartidos?",
                    "¿Los objetos personales cuentan con una ubicación definida?",
                    "¿Existe un lugar definido para las pizarras de corcho y/o acrílico?",
                    "¿Las zonas de tránsito estan libres de obstáculos?",
                    "¿Las conexiones eléctricas se observan ordenadas?"
                ]
            },
            {
                phase: "3ra S",
                criteria: "LIMPIEZA",
                questions: [
                    "¿Los documentos que utiliza estan limpios?",
                    "¿Se evidencia la limpieza en los estantes?",
                    "¿Se evidencia la limpieza en computadoras?",
                    "¿Se evidencia la limpieza en las impresoras?",
                    "¿Se evidencia la limpieza en las ventanas y/o mamparas de vidrio?",
                    "¿Se evidencia la limpieza en las pizarras (de corcho y/o acrílicos)?",
                    "¿Se evidencia la limpieza en los escritorios y sillas?",
                    "¿Se evidencia la limpieza en los demás objetos necesarios (ej. muebles) en el área?",
                    "¿Se evidencia la limpieza en el piso?",
                    "¿Se evidencia la limpieza en las paredes?"
                ]
            },
            {
                phase: "4ta S",
                criteria: "MANTENIMIENTO DE LAS 3 PRIMERAS S's",
                questions: [
                    "¿Se observa el color de cinta de files por nivel?",
                    "¿Se observa el color de los files según Tabla de colores por área?",
                    "¿Se observa la rotulación de los files?",
                    "¿Se observa la rotulación de los estantes?",
                    "¿Se observan las demarcaciones de estantes, escritorios y muebles?",
                    "¿Se observan los rótulos de los cajones de escritorios, computadoras, impresoras, etc.?",
                    "¿Se observan las demarcaciones de los tachos de basura?",
                    "¿Se observan los rótulos de los tachos de basura?",
                    "¿Se observan identificados los espacios para los demás objetos necesarios (ej. casco)?"
                ]
            },
            {
                phase: "5ta S",
                criteria: "DISCIPLINA",
                questions: [
                    "¿El personal esta informado y entrenado en sus responsabilidades para el mantenimiento de las 5'S?",
                    "¿Existen observaciones realizadas en auditorias anteriores que no han sido corregidas o que se repiten?",
                    "¿El área cumplió con la publicación de los datos y evidencias de la última auditoria en su pizarra (acrílica o de corcho)?"
                ]
            }
        ];

        const form = document.getElementById('inspectionForm');
        let currentQuestionIndex = 0;
        let questionFiles = {}; // Objeto para almacenar archivos por pregunta
        
        const flatChecklist = [];
        checklistData.forEach(section => {
            section.questions.forEach(questionText => {
                flatChecklist.push({
                    phase: section.phase,
                    criteria: section.criteria,
                    question: questionText
                });
            });
        });

        flatChecklist.forEach((item, index) => {
            questionFiles[index] = []; // Inicializar el array de archivos para cada pregunta
            const itemDiv = document.createElement('div');
            itemDiv.className = 'checklist-item';
            itemDiv.id = `item-${index}`;
            itemDiv.innerHTML = `
                <div class="question-card">
                    <div class="category-header">
                        <h3>${item.phase}: ${item.criteria}</h3>
                    </div>
                    <p class="question">${index + 1}. ${item.question}</p>
                    <div class="options">
                        <input type="radio" id="yes-${index}" name="option-${index}" value="Sí" onchange="handleOptionChange(${index}, false)" checked>
                        <label for="yes-${index}"><i class="fas fa-check"></i> Sí</label>
                        
                        <input type="radio" id="no-${index}" name="option-${index}" value="No" onchange="handleOptionChange(${index}, true)">
                        <label for="no-${index}"><i class="fas fa-times"></i> No</label>

                        <input type="radio" id="na-${index}" name="option-${index}" value="No Aplica" onchange="handleOptionChange(${index}, false)">
                        <label for="na-${index}"><i class="fas fa-ban"></i> N/A</label>
                    </div>
                    <div class="hidden-fields" id="hidden-fields-${index}">
                        <label for="observation-${index}">Observación (Obligatorio si la respuesta es 'No'):</label>
                        <textarea id="observation-${index}" name="observation-${index}" rows="3"></textarea>
                        
                        <label>Evidencia(s) (hasta 5 fotos):</label>
                        <label for="photo-${index}" class="file-upload-label"><i class="fas fa-camera"></i> Añadir Evidencia</label>
                        <input type="file" id="photo-${index}" name="photo-${index}" accept="image/*" capture="environment" multiple onchange="handleFileSelect(${index}, this)">
                        <div class="preview-container" id="preview-container-${index}"></div>
                    </div>
                </div>
            `;
            form.appendChild(itemDiv);
        });

        function showQuestion(index) {
            document.querySelectorAll('.checklist-item').forEach((q, i) => q.classList.toggle('active', i === index));
            updateProgress();
            updateNavigationButtons();
        }

        function nextQuestion() {
            if (currentQuestionIndex < flatChecklist.length - 1) {
                currentQuestionIndex++;
                showQuestion(currentQuestionIndex);
            }
        }
        
        function prevQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                showQuestion(currentQuestionIndex);
            }
        }

        function handleOptionChange(index, showHiddenFields) {
            document.getElementById(`hidden-fields-${index}`).classList.toggle('visible', showHiddenFields);
        }
        
        function updateProgress() {
            const totalQuestions = flatChecklist.length;
            const progress = totalQuestions > 0 ? ((currentQuestionIndex + 1) / totalQuestions) * 100 : 0;
            document.getElementById('progressBar').style.width = `${progress}%`;
            document.getElementById('progressText').textContent = `Paso ${currentQuestionIndex + 1} de ${totalQuestions}`;
        }
        
        function updateNavigationButtons() {
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            const exportBtn = document.getElementById('exportBtn');
            
            prevBtn.disabled = currentQuestionIndex === 0;
            
            if (currentQuestionIndex === flatChecklist.length - 1) {
                nextBtn.style.display = 'none';
                exportBtn.style.display = 'flex';
            } else {
                nextBtn.style.display = 'flex';
                exportBtn.style.display = 'none';
            }
        }

        function handleFileSelect(index, input) {
            const newFiles = Array.from(input.files);
            const existingFiles = questionFiles[index] || [];
            
            if (existingFiles.length + newFiles.length > 5) {
                alert("No puedes añadir más de 5 imágenes en total.");
                input.value = ""; // Limpiar el input
                return;
            }

            questionFiles[index] = [...existingFiles, ...newFiles];
            renderPreviews(index);
            input.value = ""; // Limpiar el input para permitir volver a seleccionar el mismo archivo si se elimina
        }

        function renderPreviews(index) {
            const previewContainer = document.getElementById(`preview-container-${index}`);
            previewContainer.innerHTML = ''; // Limpiar vistas previas existentes

            const files = questionFiles[index] || [];

            files.forEach((file, fileIndex) => {
                const reader = new FileReader();
                reader.onload = e => {
                    const wrapper = document.createElement('div');
                    wrapper.className = 'preview-wrapper';

                    const img = document.createElement('img');
                    img.src = e.target.result;
                    img.className = 'preview-image';

                    const deleteBtn = document.createElement('div');
                    deleteBtn.className = 'delete-btn';
                    deleteBtn.innerHTML = '&times;'; // El caracter 'x'
                    deleteBtn.onclick = () => removeFile(index, fileIndex);

                    wrapper.appendChild(img);
                    wrapper.appendChild(deleteBtn);
                    previewContainer.appendChild(wrapper);
                }
                reader.readAsDataURL(file);
            });
        }

        function removeFile(questionIndex, fileIndex) {
            if (questionFiles[questionIndex]) {
                questionFiles[questionIndex].splice(fileIndex, 1);
                renderPreviews(questionIndex); // Volver a renderizar las vistas previas
            }
        }

        function readFileAsArrayBuffer(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = () => resolve(reader.result);
                reader.onerror = reject;
                reader.readAsArrayBuffer(file);
            });
        }

        async function exportToExcel() {
            const exportBtn = document.getElementById('exportBtn');
            exportBtn.disabled = true;
            exportBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generando archivo...';

            try {
                const workbook = new ExcelJS.Workbook();
                const worksheet = workbook.addWorksheet('Resultados de Inspección');

                const auditor = document.getElementById('auditor').value || 'No especificado';
                const auditado = document.getElementById('auditado').value || 'No especificado';
                const area = document.getElementById('area').value || 'No especificada';
                const fecha = document.getElementById('fecha').value || 'No especificada';
                worksheet.addRow(['Datos Generales de la Inspección']).font = { bold: true, size: 14, color: { argb: 'FFFFFFFF' } };
                worksheet.mergeCells('A1:G1');
                worksheet.getCell('A1').alignment = { horizontal: 'center', vertical: 'middle' };
                worksheet.getCell('A1').fill = { type: 'pattern', pattern:'solid', fgColor:{argb:'FF3498DB'} };
                worksheet.addRow(['Auditor:', auditor]); worksheet.addRow(['Auditado:', auditado]); worksheet.addRow(['Área:', area]); worksheet.addRow(['Fecha:', fecha]);
                ['A2', 'A3', 'A4', 'A5'].forEach(cellRef => { worksheet.getCell(cellRef).font = { bold: true }; });
                worksheet.addRow([]);

                const headerRow = worksheet.addRow(['Fase', 'Criterio', 'N°', 'Pregunta Clave', 'Respuesta', 'Observación', 'Evidencia (Foto)']);
                headerRow.eachCell(cell => {
                    cell.font = { bold: true, size: 12, color: { argb: 'FFFFFFFF' } };
                    cell.fill = { type: 'pattern', pattern:'solid', fgColor:{argb:'FF3498DB'} };
                    cell.alignment = { vertical: 'middle', horizontal: 'center' };
                });
                worksheet.getColumn('A').width = 10; worksheet.getColumn('B').width = 30; worksheet.getColumn('C').width = 5; 
                worksheet.getColumn('D').width = 60; worksheet.getColumn('E').width = 15; worksheet.getColumn('F').width = 50; 
                worksheet.getColumn('G').width = 70; // Columna de evidencia más ancha
                
                for (let i = 0; i < flatChecklist.length; i++) {
                    const answer = document.querySelector(`input[name="option-${i}"]:checked`).value;
                    const observation = (answer === 'No') ? document.getElementById(`observation-${i}`).value : '';
                    
                    const row = worksheet.addRow([
                        flatChecklist[i].phase, flatChecklist[i].criteria, i + 1, flatChecklist[i].question, answer, observation
                    ]);
                    
                    row.alignment = { vertical: 'middle', wrapText: true };
                    
                    const answerCell = row.getCell('E');
                    answerCell.font = { bold: true };
                    if (answer === 'Sí') answerCell.font.color = { argb: 'FF2ECC71' };
                    else if (answer === 'No') answerCell.font.color = { argb: 'FFE74C3C' };
                    else answerCell.font.color = { argb: 'FF7f8c8d' };

                    if (answer === 'No') {
                        const filesToExport = questionFiles[i] || [];
                        if (filesToExport.length > 0) {
                            row.height = 80; // Aumentar altura de la fila para las fotos
                            let imageColOffset = 0.02;

                            for(const file of filesToExport) {
                                const imageBuffer = await readFileAsArrayBuffer(file);
                                const imageExtension = file.type.split('/')[1] || 'png';
                                const imageId = workbook.addImage({ buffer: imageBuffer, extension: imageExtension });
                                
                                worksheet.addImage(imageId, {
                                    tl: { col: 6 + imageColOffset, row: row.number - 0.98 },
                                    ext: { width: 90, height: 90 }
                                });
                                imageColOffset += 0.20; // Espaciar las imágenes
                                if (imageColOffset > 0.98) break; // Evitar que se salgan de la celda
                            }
                        }
                    }
                }
                
                // Unir celdas por categoría
                let lastPhase = ""; let phaseMergeStartRow = headerRow.number + 1;
                let lastCriteria = ""; let criteriaMergeStartRow = headerRow.number + 1;
                for (let i = 0; i < flatChecklist.length; i++) {
                    const currentRowNum = headerRow.number + 1 + i;
                    const item = flatChecklist[i];
                    if (item.phase !== lastPhase) {
                        if (i > 0) {
                            worksheet.mergeCells(`A${phaseMergeStartRow}:A${currentRowNum - 1}`);
                            worksheet.getCell(`A${phaseMergeStartRow}`).alignment = { vertical: 'middle', horizontal: 'center', wrapText: true };
                        }
                        phaseMergeStartRow = currentRowNum;
                        lastPhase = item.phase;
                    }
                    if (item.criteria !== lastCriteria) {
                        if (i > 0) {
                            worksheet.mergeCells(`B${criteriaMergeStartRow}:B${currentRowNum - 1}`);
                            worksheet.getCell(`B${criteriaMergeStartRow}`).alignment = { vertical: 'middle', horizontal: 'center', wrapText: true };
                        }
                        criteriaMergeStartRow = currentRowNum;
                        lastCriteria = item.criteria;
                    }
                }
                worksheet.mergeCells(`A${phaseMergeStartRow}:A${worksheet.lastRow.number}`);
                worksheet.getCell(`A${phaseMergeStartRow}`).alignment = { vertical: 'middle', horizontal: 'center', wrapText: true };
                worksheet.mergeCells(`B${criteriaMergeStartRow}:B${worksheet.lastRow.number}`);
                worksheet.getCell(`B${criteriaMergeStartRow}`).alignment = { vertical: 'middle', horizontal: 'center', wrapText: true };
                
                const buffer = await workbook.xlsx.writeBuffer();
                const blob = new Blob([buffer], { type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' });
                const link = document.createElement('a');
                link.href = URL.createObjectURL(blob);
                const timestamp = new Date().toISOString().slice(0,10);
                link.download = `Resultados-Inspeccion-5S-${timestamp}.xlsx`;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            
            } catch (error) {
                console.error("Error al generar el Excel:", error);
                alert("Ocurrió un error al generar el archivo Excel.");
            } finally {
                exportBtn.disabled = false;
                exportBtn.innerHTML = '<i class="fas fa-file-excel"></i> Finalizar y Exportar';
            }
        }
        
        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById('fecha').valueAsDate = new Date();
            showQuestion(currentQuestionIndex);
        });
    </script>

</body>
</html>

